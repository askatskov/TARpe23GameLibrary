{
  "swagger": "2.0",
  "info": {
    "title": "GameLibrary",
    "version": "1.0",
    "description": "### This is a Swagger UI for our GameLibrary  \n\n### Error handling\nErrors are presented using the HTTP status codes 400-599. The response includes a more detailed explanation about the error in the body.\n\n```\n{\n  \"error\": \"Cleartext explanation of the error that occurred\"\n}\n```\n\n### Generic API errors\nThese error responses can be returned by any of the described endpoints.\n\n| HTTP status  |  Description |\n|---|---|\n| 400| Bad input parameters or invalid request. More information can be found in the response body.\n| 401| The consumer does not have access to the requested resource or the provided token is not valid.\n| 404| The requested resource can not be found or the user does not have access to the resource.\n| 5XX| A server error has occurred while processing the request."
  },
  "host": "localhost:8000",
  "schemes": ["http"],
  "basePath": "/api/v1",
  "tags": [
    {
      "name": "Games",
      "description": "Operations related to games"
    }
  ],
  "paths": {
    "/games": {
      "get": {
        "tags": ["Games"],
        "summary": "Get all games",
        "produces": ["application/json"],
        "responses": {
          "200": {
            "description": "List of games",
            "schema": {
              "type": "array",
              "items": { "$ref": "#/definitions/GamesListItem" }
            }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      },
      "post": {
        "tags": ["Games"],
        "summary": "Create game",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "description": "Game to be created - without ID",
            "schema": { "$ref": "#/definitions/NewGame" }
          }
        ],
        "responses": {
          "201": {
            "description": "Created game",
            "schema": { "$ref": "#/definitions/Game" }
          },
          "400": {
            "description": "Validation or business rule error",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      }
    },
    "/games/featured": {
      "get": {
        "tags": ["Games"],
        "summary": "Get featured games",
        "description": "Returns top rated games (limit 5).",
        "produces": ["application/json"],
        "responses": {
          "200": {
            "description": "Featured games",
            "schema": {
              "type": "array",
              "items": { "$ref": "#/definitions/GamesListItem" }
            }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      }
    },
    "/games/{id}": {
      "get": {
        "tags": ["Games"],
        "summary": "Get a game",
        "produces": ["application/json"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int32"
          }
        ],
        "responses": {
          "200": {
            "description": "Return the requested game details",
            "schema": { "$ref": "#/definitions/Game" }
          },
          "404": {
            "description": "Game not found",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "400": {
            "description": "Invalid ID supplied",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      },
      "put": {
        "tags": ["Games"],
        "summary": "Update game with given values",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "description": "Game fields to be updated",
            "schema": { "$ref": "#/definitions/UpdateGame" }
          }
        ],
        "responses": {
          "200": {
            "description": "Game updated",
            "schema": { "$ref": "#/definitions/Game" }
          },
          "400": {
            "description": "Validation or business rule error",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "404": {
            "description": "Game not found",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      },
      "delete": {
        "tags": ["Games"],
        "summary": "Delete game",
        "produces": ["application/json"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int32"
          }
        ],
        "responses": {
          "204": {
            "description": "Game deleted"
          },
          "404": {
            "description": "Game not found",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "400": {
            "description": "Invalid ID supplied",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      }
    },
    "/games/{id}/price-history": {
      "get": {
        "tags": ["Games"],
        "summary": "Get price history for a game",
        "produces": ["application/json"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int32"
          }
        ],
        "responses": {
          "200": {
            "description": "Price history entries",
            "schema": {
              "type": "array",
              "items": { "$ref": "#/definitions/PricePoint" }
            }
          },
          "404": {
            "description": "Game not found",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      }
    },
    "/games/{id}/reviews": {
      "get": {
        "tags": ["Games"],
        "summary": "Get reviews for a game",
        "produces": ["application/json"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int32"
          }
        ],
        "responses": {
          "200": {
            "description": "List of reviews",
            "schema": {
              "type": "array",
              "items": { "$ref": "#/definitions/Review" }
            }
          },
          "404": {
            "description": "Game not found",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      },
      "post": {
        "tags": ["Games"],
        "summary": "Add review to a game",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "description": "Review to be added",
            "schema": { "$ref": "#/definitions/NewReview" }
          }
        ],
        "responses": {
          "201": {
            "description": "Review created",
            "schema": { "$ref": "#/definitions/Review" }
          },
          "400": {
            "description": "Validation error (e.g., missing rating)",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "404": {
            "description": "Game not found",
            "schema": { "$ref": "#/definitions/Error" }
          },
          "500": {
            "description": "Server error",
            "schema": { "$ref": "#/definitions/Error" }
          }
        }
      }
    }
  },
  "definitions": {
    "GamesListItem": {
      "type": "object",
      "properties": {
        "id": { "type": "integer", "format": "int32" },
        "name": { "type": "string" },
        "developer": { "type": "string" },
        "genre": { "type": "string" },
        "price": { "type": "number", "format": "double" },
        "rating": { "type": "number", "format": "double" },
        "imageUrl": { "type": "string" }
      },
      "example": {
        "id": 1,
        "name": "Minecraft",
        "developer": "Mojang",
        "genre": "Sandbox",
        "price": 29.99,
        "rating": 9.5,
        "imageUrl": "https://example.com/minecraft.jpg"
      }
    },
    "Game": {
      "type": "object",
      "properties": {
        "id": { "type": "integer", "format": "int32" },
        "name": { "type": "string" },
        "developer": { "type": "string" },
        "genre": { "type": "string" },
        "releaseDate": { "type": "string", "format": "date-time" },
        "price": { "type": "number", "format": "double" },
        "rating": { "type": "number", "format": "double" },
        "imageUrl": { "type": "string" },
        "priceHistory": {
          "type": "array",
          "items": { "$ref": "#/definitions/PricePoint" }
        },
        "reviews": {
          "type": "array",
          "items": { "$ref": "#/definitions/Review" }
        }
      },
      "example": {
        "id": 1,
        "name": "Minecraft",
        "developer": "Mojang",
        "genre": "Sandbox",
        "releaseDate": "2011-11-18T00:00:00.000Z",
        "price": 29.99,
        "rating": 9.5,
        "imageUrl": "https://example.com/minecraft.jpg",
        "priceHistory": [
          { "date": "2024-01-01T00:00:00.000Z", "price": 29.99 },
          { "date": "2024-06-01T00:00:00.000Z", "price": 24.99 }
        ],
        "reviews": [
          {
            "username": "Player1",
            "rating": 9,
            "comment": "Great game!",
            "createdAt": "2024-06-10T12:34:56.000Z"
          }
        ]
      }
    },
    "NewGame": {
      "type": "object",
      "required": ["name", "genre", "imageUrl"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Required, unique, at least 2 characters"
        },
        "developer": {
          "type": "string",
          "description": "Optional developer name"
        },
        "genre": {
          "type": "string",
          "description": "Required game genre"
        },
        "imageUrl": {
          "type": "string",
          "description": "Required image URL"
        },
        "releaseDate": {
          "type": "string",
          "format": "date-time",
          "description": "Optional release date"
        },
        "price": {
          "type": "number",
          "format": "double",
          "description": "Optional price"
        },
        "rating": {
          "type": "number",
          "format": "double",
          "description": "Optional initial rating"
        }
      },
      "example": {
        "name": "Doom",
        "developer": "id Software",
        "genre": "FPS",
        "imageUrl": "https://example.com/doom.jpg",
        "releaseDate": "1993-12-10T00:00:00.000Z",
        "price": 19.99,
        "rating": 9.0
      }
    },
    "UpdateGame": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "developer": { "type": "string" },
        "genre": { "type": "string" },
        "imageUrl": { "type": "string" },
        "releaseDate": { "type": "string", "format": "date-time" },
        "price": { "type": "number", "format": "double" },
        "rating": { "type": "number", "format": "double" }
      },
      "example": {
        "name": "Minecraft (Updated)",
        "price": 24.99
      }
    },
    "PricePoint": {
      "type": "object",
      "properties": {
        "date": {
          "type": "string",
          "format": "date-time",
          "description": "Date of this price entry"
        },
        "price": {
          "type": "number",
          "format": "double",
          "description": "Price at that time"
        }
      },
      "example": {
        "date": "2024-01-01T00:00:00.000Z",
        "price": 19.99
      }
    },
    "Review": {
      "type": "object",
      "properties": {
        "username": { "type": "string" },
        "rating": { "type": "number", "format": "double" },
        "comment": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "example": {
        "username": "Anon端端mne",
        "rating": 8.5,
        "comment": "Very fun game!",
        "createdAt": "2024-06-10T12:34:56.000Z"
      }
    },
    "NewReview": {
      "type": "object",
      "required": ["rating"],
      "properties": {
        "username": {
          "type": "string",
          "description": "Optional, defaults to 'Anon端端mne'"
        },
        "rating": {
          "type": "number",
          "format": "double",
          "description": "Required rating from 0 to 10"
        },
        "comment": {
          "type": "string",
          "description": "Optional comment"
        }
      },
      "example": {
        "username": "Artjom",
        "rating": 9.5,
        "comment": "One of my favorite games."
      }
    },
    "Error": {
      "type": "object",
      "properties": {
        "error": { "type": "string" }
      },
      "example": {
        "error": "Error message"
      }
    }
  }
}
